<!DOCTYPE html>
<html lang="ht">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <title>Adam_D'H7</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#000000" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Adam_D'H7" />
  <link rel="apple-touch-icon" href="https://res.cloudinary.com/dckwrqrur/image/upload/v1757205404/tf-stream-url/Screenshot_20250906_202106_Chrome_go9vhu.png" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    :root{
      --card-max-width:920px;
      --card-min-height:80px;
      --card-max-height:80vh;
      --mini-w:100px;
      --mini-h:70px;
      --bg:#000;  
      --muted:#9aa0a6;  
      --accent:#fff;  
      --seek-height:8px;  
      --box-bg: rgba(255,255,255,0.02);  
      --box-border: rgba(255,255,255,0.03);  
    }
    html,body{height:100%;}
    body{
      margin:0;
      background:#000;
      color:#fff;
      font-family:'Roboto',sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding-bottom:60px;
    }

    .header{ padding:18px 16px; text-align:center; position:sticky; top:0; backdrop-filter: blur(10px); background: rgba(0,0,0,0.7); z-index:10; }
    .logo{ font-size:26px; font-weight:700; background:linear-gradient(90deg,#fff,#000); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
    .search-container{ display:flex; justify-content:center; padding:8px 20px; }
    .search-box{ width:100%; max-width:500px; background:#1c1c1e; border:none; padding:10px 14px; border-radius:12px; color:#fff; font-size:15px; outline:none; }

    #explorerView{ padding:18px; max-height:calc(100vh - 120px); overflow-y:auto; background:#000; -webkit-overflow-scrolling:touch; }

    .post-card{ background:#111; border-radius:14px; padding:14px; margin-bottom:18px; box-shadow:0 2px 8px rgba(0,0,0,0.7); }
    .post-name{ font-weight:700; font-size:16px; margin:8px 0; color:#fff; text-align:left; }
    .post-text{ font-size:14px; color:#ddd; margin-bottom:10px; white-space:pre-wrap; text-align:left; }
    .post-desc{ font-size:13px; color:#ccc; margin-top:8px; text-align:left; }

    .media-wrap{ text-align:center; margin: 0 0 10px 0; }

    .post-thumb-container {
      position:relative;
      display:inline-block;
      box-sizing:border-box;
      max-width:var(--card-max-width);
      width:auto;
      background:#000;
      border-radius:12px;
      overflow:hidden;
      padding:0;
      box-shadow: inset 0 0 18px rgba(0,0,0,0.45), 0 6px 18px rgba(0,0,0,0.6);
      min-height:var(--card-min-height);
      max-height:var(--card-max-height);
    }

    .post-thumb, .post-thumb img, .post-thumb video, .post-thumb iframe { display:block; width:auto; max-width:100%; height:auto; max-height:calc(var(--card-max-height)); object-fit:contain; background:#000; border-radius:0; }
    .post-thumb iframe, .post-thumb video { display:block; width:100%; height:auto; }

    .social-section{ margin-top:10px; padding-top:10px; border-top:1px solid #333; display:flex; justify-content:center; gap:18px; flex-wrap:wrap; }
    .social-section a{ color:#fff; text-decoration:none; display:inline-flex; align-items:center; justify-content:center; width:44px; height:44px; border-radius:10px; background:rgba(255,255,255,0.03); }
    .social-section i{ font-size:18px; }

    @media (max-width:600px) {
      :root { --mini-w:86px; --mini-h:62px; }
    }

    #sw-update-banner{
      position:fixed;
      left:12px;
      right:12px;
      bottom:12px;
      background:#111;
      color:#fff;
      padding:10px 14px;
      border-radius:8px;
      box-shadow:0 6px 18px rgba(0,0,0,.4);
      font-family:sans-serif;
      text-align:center;
      z-index:99999;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
    }
    #sw-update-banner button{
      background:#1a73e8;
      color:#fff;
      border:0;
      padding:8px 12px;
      border-radius:6px;
      cursor:pointer;
    }

    #explorerView {
      -ms-overflow-style: none;
      scrollbar-width: none;
      touch-action: pan-y;
    }
    #explorerView::-webkit-scrollbar {
      display: none;
      width: 0;
      height: 0;
    }

    *{box-sizing:border-box}  
    .wrap, .video-card, .controls-wrap, .inside-mini-controls, .menu-overlay, .lang-overlay { user-select:none; -webkit-user-select:none; -ms-user-select:none; -moz-user-select:none; }  .wrap{max-width:1100px;margin:28px auto;padding:12px;width:95%}

.video-card{position:relative;border-radius:12px;overflow:hidden;background:#000;aspect-ratio:16/9;max-height:68vh;min-height:180px;touch-action:none}
video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:1;background:#000;transition:filter .08s linear}
video.contain{ object-fit:contain; background:#000; }

.controls-wrap{position:absolute;left:12px;right:12px;bottom:12px;pointer-events:none;z-index:12;transition:opacity .18s ease}
.time-row{display:flex;align-items:center;gap:12px;padding:8px 12px;color:var(--muted);font-size:14px;justify-content:center}
.time{width:82px;text-align:center;font-variant-numeric:tabular-nums}
.progress{flex:1;max-width:820px;display:flex;align-items:center}
.seek{position:relative;height:var(--seek-height);width:100%;border-radius:999px;cursor:pointer;background:repeating-linear-gradient(90deg, rgba(255,255,255,0.06) 0 2px, rgba(255,255,255,0) 2px 12px);}
.fill{position:absolute;left:0;top:0;height:100%;width:0%;border-radius:999px;background:linear-gradient(90deg, rgba(255,255,255,0.95), rgba(255,255,255,0.55));}
.thumb{position:absolute;top:50%;transform:translate(-50%,-50%);width:18px;height:18px;border-radius:50%;background:#0b0b0b;border:2px solid var(--accent);box-shadow:none;pointer-events:auto;touch-action:none}

.controls-hidden{opacity:0;pointer-events:none}
.controls-visible{opacity:1;pointer-events:auto}

.inside-mini-controls{
position:absolute;
left:12px;
right:12px;
bottom:92px;
z-index:13;
display:flex;
justify-content:center;
gap:14px;
pointer-events:auto;
transition:bottom .18s ease, opacity .18s ease;
}
.inside-hidden{opacity:0;pointer-events:none}
.inside-visible{opacity:1;pointer-events:auto}
.video-card.landscape-mode .inside-mini-controls{ bottom:160px; }

.inside-item{
min-width:86px;
display:flex;
align-items:center;
justify-content:center;
padding:8px;
border-radius:10px;
background:var(--box-bg);
border:1px solid var(--box-border);
}
.inside-item .mini-btn{
width:100%;
height:44px;
border-radius:8px;
border:none;
background:transparent;
color:var(--accent);
font-weight:700;
font-size:15px;
display:inline-flex;
align-items:center;
justify-content:center;
cursor:pointer;
-webkit-tap-highlight-color: transparent;
}
.inside-item .mini-btn:active{transform:translateY(1px)}
@media (orientation:landscape) { .inside-item{min-width:110px;padding:10px} }

.landscape-btn{margin-left:8px;border:none;background:transparent;color:var(--muted);font-size:18px;cursor:pointer}
.landscape-btn:hover{color:var(--accent)}

.menu-dots{margin-left:6px;border:none;background:transparent;color:var(--muted);font-size:18px;cursor:pointer;display:none;padding:6px;border-radius:8px}
.video-card.landscape-mode .menu-dots{ display:inline-block; }
@media (orientation:landscape) { .menu-dots { display:inline-block; } }
.menu-dots:hover{color:var(--accent);background:rgba(255,255,255,0.02)}

.swipe-indicator{
position:absolute;
left:50%;
top:50%;
transform:translate(-50%,-50%);
min-width:140px;
padding:10px 14px;
border-radius:10px;
background:rgba(0,0,0,0.75);
color:var(--accent);
display:flex;
align-items:center;
gap:10px;
justify-content:center;
z-index:20;
pointer-events:none;
opacity:0;
transition:opacity .12s ease;
font-weight:700;
font-size:15px;
}
.swipe-indicator.show{opacity:1}
.swipe-icon{width:22px;height:22px;flex:0 0 22px}
.swipe-value{min-width:48px;text-align:right;font-variant-numeric:tabular-nums}

.error{position:absolute;left:12px;right:12px;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.6);padding:16px;border-radius:10px;color:#ff9b9b;display:none;text-align:center;z-index:20}
.error a{color:#fff;text-decoration:underline}

.menu-overlay, .lang-overlay {
position:fixed;
inset:0;
display:flex;
align-items:center;
justify-content:center;
z-index:99999;
pointer-events:auto;
opacity:0;
visibility:hidden;
transition:opacity .14s ease, visibility .14s;
}
.menu-overlay.show, .lang-overlay.show { opacity:1; visibility:visible; }
.menu-backdrop, .lang-backdrop { position:absolute; inset:0; z-index:99990; background:rgba(0,0,0,0.5); }
.menu-sheet, .lang-sheet {
position:relative;
z-index:99999;
min-width:280px;
max-width:92%;
border-radius:12px;
background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
border:1px solid rgba(255,255,255,0.04);
padding:16px;
color:var(--accent);
box-shadow: 0 10px 30px rgba(0,0,0,0.6);
}
.menu-header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.back-btn{background:transparent;border:none;color:var(--muted);font-size:16px;display:flex;align-items:center;gap:8px;cursor:pointer;padding:6px;border-radius:8px}
.back-btn:hover{color:var(--accent);background:rgba(255,255,255,0.02)}
.close-btn{margin-left:auto;background:transparent;border:none;color:var(--muted);font-size:18px;cursor:pointer;padding:6px;border-radius:8px}
.close-btn:hover{color:var(--accent);background:rgba(255,255,255,0.02)}

.menu-list{display:flex;flex-direction:column;gap:8px}
.menu-item{padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);cursor:pointer;border:1px solid rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:space-between}
.menu-item:hover{background:rgba(255,255,255,0.03)}
.menu-item strong{font-weight:700}

.lang-list{display:flex;flex-direction:column;gap:8px;margin-top:8px}
.lang-item{padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);cursor:pointer;border:1px solid rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:space-between}
.lang-item:hover{background:rgba(255,255,255,0.03)}
.bold{font-weight:800}
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">Adam_D'H7</div>
    <div class="search-container">
      <input id="searchBox" class="search-box" placeholder="Rechèch..." oninput="filterSearch(this.value)">
    </div>
  </div>
  <div id="explorerView" role="main" aria-live="polite"></div>
  <script>
    const AD_REDIRECT_URL = "https://www.effectivegatecpm.com/sb8frb30?key=b74cd3abdfc6db3be0c0b8d215fcb582";

    function logAdEvent(action, extra = {}) {
      try {
        const logs = JSON.parse(localStorage.getItem('adLogs') || '[]');
        logs.push({ action, extra, t: new Date().toISOString() });
        while (logs.length > 1000) logs.shift();
        localStorage.setItem('adLogs', JSON.stringify(logs));
      } catch (e) { console.warn('logAdEvent error', e); }
    }

    function tryOpenAdInBrowser(url) {
      try {
        const newWin = window.open(url, '_blank');
        if (newWin) {
          newWin.focus();
          logAdEvent('tab_opened', { url });
          return true;
        }
        return false;
      } catch (e) {
        return false;
      }
    }

    let allData = [];

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j] = [array[j], array[i]];
      }
      return array;
    }

    fetch("index.json")
      .then(r => r.json())
      .then(files => Promise.all(files.map(f => fetch(f).then(r => r.json()))))
      .then(jsons => {
        jsons.forEach(d => Array.isArray(d) ? allData.push(...d) : allData.push(d));
        shuffle(allData);
        displayExplorer(allData);
      }).catch(err => {
        console.error("Erreur chargement JSON:", err);
        const ex = document.getElementById("explorerView");
        ex.innerHTML = '<div style="color:#999;padding:20px;text-align:center">Pa kapab chaje kontni (index.json).</div>';
      });

    function filterSearch(val){
      const txt = (val || "").toLowerCase();
      const filtered = allData.filter(p =>
        ((p.Catégorie || p.Categorie || p.category || "").toString().toLowerCase() === "poste") &&
        (
          (p.Texte||p.Bio||p.Info||"").toString().toLowerCase().includes(txt) ||
          (p.Name||"").toString().toLowerCase().includes(txt) ||
          (p.Description||p.Desc||"").toString().toLowerCase().includes(txt)
        )
      );
      displayExplorer(filtered);
    }

    function displayExplorer(data){
      const ex = document.getElementById("explorerView");
      ex.innerHTML = "";
      data.forEach((post) => {
        if (((post.Catégorie||post.Categorie||"" )).toString().toLowerCase() !== "poste") return;

        const card = document.createElement("div");
        card.className = "post-card";

        const ptext = document.createElement("div");
        ptext.className = "post-text";
        ptext.textContent = post.Texte || post.Bio || post.Info || "";
        card.appendChild(ptext);

        const title = document.createElement("div");
        title.className = "post-name";
        title.textContent = post.Name || "";
        card.appendChild(title);

        const mediaWrap = document.createElement("div");
        mediaWrap.className = "media-wrap";

        const thumbCon = document.createElement("div");
        thumbCon.className = "post-thumb-container";

        const thumbSrc = post["Url Thumb"] || post.Previously || post.image || post.thumb || "";
        const img = document.createElement("img");
        img.className = "post-thumb";
        img.alt = post.Description || post.Name || "";
        img.loading = "lazy";
        img.src = thumbSrc || "https://via.placeholder.com/800x450?text=Preview";

        thumbCon.appendChild(img);
        mediaWrap.appendChild(thumbCon);
        card.appendChild(mediaWrap);

        const desc = document.createElement("div");
        desc.className = "post-desc";
        desc.textContent = post.Description || post.Desc || post.Texte || "";
        card.appendChild(desc);

        thumbCon.addEventListener("click", (ev) => {
          ev.stopPropagation();
          const src = post.Previously || post.video || post["Url Video"] || post["Url"] || post.image || post.media || "";
          if (!thumbCon.querySelector('.video-card')) {
            tryOpenAdInBrowser(AD_REDIRECT_URL);
          }
          playMedia(src, thumbCon);
        });

        ex.appendChild(card);
      });

      displaySocialLinks();
    }

    function looksLikeVideo(src){
      if (!src) return false;
      try {
        const url = src.toString().split('?')[0].toLowerCase();
        if (/\.(mp4|webm|ogg|mov|mkv)$/.test(url)) return true;
        if (src.includes("youtube.com") || src.includes("youtu.be") || src.includes("vimeo.com")) return true;
      } catch(e){}
      return false;
    }

    function normalizeYouTubeEmbed(src){
      try {
        if (src.includes("youtu.be/")) {
          const id = src.split("youtu.be/")[1].split(/[?&]/)[0];
          return "https://www.youtube.com/embed/" + id + "?autoplay=1&rel=0";
        }
        const u = new URL(src);
        const vParam = u.searchParams.get('v');
        if (vParam) return "https://www.youtube.com/embed/" + vParam + "?autoplay=1&rel=0";
      } catch(e){}
      return src;
    }

    function normalizeVimeoEmbed(src){
      try {
        const parts = src.split('/');
        const id = parts.pop() || parts.pop();
        return "https://player.vimeo.com/video/" + id + "?autoplay=1";
      } catch(e){}
      return src;
    }

    function adjustIFrameSize(iframe, container){
      try {
        const cw = container.clientWidth || iframe.clientWidth || Math.min(window.innerWidth, parseInt(getComputedStyle(container).maxWidth) || window.innerWidth);
        const h = Math.round(cw * 9 / 16);
        iframe.style.width = cw + "px";
        iframe.style.height = h + "px";
      } catch(e){}
    }

    function playMedia(src, container){
      if (!src) return;
      container.innerHTML = "";

      const isVideo = looksLikeVideo(src);
      if (isVideo){
        if (src.includes("youtube.com") || src.includes("youtu.be")) {
          const iframe = document.createElement("iframe");
          iframe.src = normalizeYouTubeEmbed(src);
          iframe.allow = "autoplay; fullscreen; picture-in-picture";
          iframe.style.border = "none";
          iframe.style.display = "block";
          container.appendChild(iframe);
          setTimeout(() => adjustIFrameSize(iframe, container), 60);
        } else if (src.includes("vimeo.com")) {
          const iframe = document.createElement("iframe");
          iframe.src = normalizeVimeoEmbed(src);
          iframe.allow = "autoplay; fullscreen; picture-in-picture";
          iframe.style.border = "none";
          iframe.style.display = "block";
          container.appendChild(iframe);
          setTimeout(() => adjustIFrameSize(iframe, container), 60);
        } else {
          container.innerHTML = `
            <div class="video-card">
              <video preload="auto" playsinline crossorigin="anonymous">
                <source src="${src}" type="video/mp4">
                Votre navigateur ne supporte pas la vidéo HTML5.
              </video>
              <div class="inside-mini-controls inside-visible">
                <div class="inside-item"><button class="mini-btn">-10</button></div>
                <div class="inside-item"><button class="mini-btn">❚❚</button></div>
                <div class="inside-item"><button class="mini-btn">+10</button></div>
              </div>
              <div class="controls-wrap controls-visible">
                <div class="time-row">
                  <div class="time">0:00</div>
                  <div class="progress">
                    <div class="seek" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
                      <div class="fill"></div>
                      <div class="thumb" aria-hidden="true"></div>
                    </div>
                  </div>
                  <div class="time">0:00</div>
                  <button class="landscape-btn" title="Basculer paysage">⛶</button>
                  <button class="menu-dots" title="Menu">⋯</button>
                </div>
              </div>
              <div class="swipe-indicator" aria-hidden="true">
                <div class="swipe-icon"></div>
                <div class="swipe-value">0%</div>
              </div>
              <div class="error">Impossible de lire la vidéo. <span></span></div>
              <!-- MENU OVERLAY (backdrop covers entire viewport at 50% and video keeps playing) -->    
              <div class="menu-overlay" aria-hidden="true" role="dialog" aria-modal="true">
                <div class="menu-backdrop"></div>
                <div class="menu-sheet" role="document" aria-label="Menu player">
                  <div class="menu-header">
                    <button class="back-btn" title="Retour" aria-label="Retour" style="display:none">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="color:var(--muted)"><path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                      Retour
                    </button>
                    <strong style="font-weight:700">Options</strong>
                    <button class="close-btn" title="Fermer" aria-label="Fermer">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="color:var(--muted)"><path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </button>
                  </div>
                  <div class="menu-list">
                    <div class="menu-item" role="button" tabindex="0">
                      <span>Langue</span>
                      <span aria-hidden="true">›</span>
                    </div>
                    <div class="menu-item" role="button" tabindex="0">
                      <span>Mode PIP</span>
                      <span style="opacity:.8;font-size:13px">Activer</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- LANGUAGE OVERLAY (covers menu when opened; video still plays) -->    
              <div class="lang-overlay" aria-hidden="true" role="dialog" aria-modal="true">
                <div class="lang-backdrop"></div>
                <div class="lang-sheet" role="document" aria-label="Langue settings">
                  <div class="menu-header">
                    <button class="back-btn" title="Retour" aria-label="Retour">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="color:var(--muted)"><path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                      Retour
                    </button>
                    <strong style="font-weight:700">Langue</strong>
                    <button class="close-btn" title="Fermer" aria-label="Fermer">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="color:var(--muted)"><path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </button>
                  </div>
                  <div class="lang-list">
                    <div class="lang-item"><strong class="bold">Audio</strong><span style="opacity:.8">Français</span></div>
                    <div class="lang-item"><strong class="bold">Sous-titre</strong><span style="opacity:.8">Français</span></div>
                  </div>
                </div>
              </div>
            </div>
          `;
          initPlayer(container);
        }
      } else {
        const imgEl = document.createElement("img");
        imgEl.src = src;
        imgEl.loading = "lazy";
        imgEl.alt = "";
        imgEl.style.display = "block";
        imgEl.style.width = "auto";
        imgEl.style.maxWidth = "100%";
        imgEl.style.height = "auto";
        imgEl.style.objectFit = "contain";
        container.appendChild(imgEl);
        imgEl.addEventListener('error', () => {
          container.innerHTML = '<div style="color:#999;padding:12px;text-align:center">Imaj pa disponib</div>';
        });
      }
    }

    function initPlayer(container) {
      const card = container.querySelector('.video-card');
      const video = card.querySelector('video');
      if (!video) return;

      const insidePlay = card.querySelector('.inside-mini-controls .mini-btn:nth-child(2)');
      const insideForward = card.querySelector('.inside-mini-controls .mini-btn:nth-child(3)');
      const insideBack = card.querySelector('.inside-mini-controls .mini-btn:nth-child(1)');
      const seekBar = card.querySelector('.seek');
      const fill = card.querySelector('.fill');
      const thumb = card.querySelector('.thumb');
      const currentEl = card.querySelector('.time:nth-child(1)');
      const durationEl = card.querySelector('.time:nth-child(3)');
      const landscapeBtn = card.querySelector('.landscape-btn');
      const menuBtn = card.querySelector('.menu-dots');
      const controlsWrap = card.querySelector('.controls-wrap');
      const insideMini = card.querySelector('.inside-mini-controls');
      const swipeIndicator = card.querySelector('.swipe-indicator');
      const swipeIcon = card.querySelector('.swipe-icon');
      const swipeValue = card.querySelector('.swipe-value');
      const menuOverlay = card.querySelector('.menu-overlay');
      const menuBackdrop = card.querySelector('.menu-backdrop');
      const menuCloseBtn = card.querySelector('.menu-overlay .close-btn');
      const menuLang = card.querySelector('.menu-overlay .menu-item:nth-child(1)');
      const menuPip = card.querySelector('.menu-overlay .menu-item:nth-child(2)');
      const pipStatus = card.querySelector('.menu-overlay .menu-item:nth-child(2) span:nth-child(2)');
      const langOverlay = card.querySelector('.lang-overlay');
      const langBackdrop = card.querySelector('.lang-backdrop');
      const langCloseBtn = card.querySelector('.lang-overlay .close-btn');
      const langBackBtn = card.querySelector('.lang-overlay .back-btn');
      const errorBox = card.querySelector('.error');
      const errTxt = card.querySelector('.error span');

      const svgBrightness = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="M12 4V2M12 22v-2M4.93 4.93L3.51 3.51M20.49 20.49l-1.42-1.42M4 12H2M22 12h-2M4.93 19.07l-1.42 1.42M20.49 3.51l-1.42 1.42M12 8a4 4 0 100 8 4 4 0 000-8z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>`;
      const svgVolume = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="M11 5L6 9H2v6h4l5 4V5z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M19 9a5 5 0 010 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>`;

      const cornerRatio = 0.20;

      function formatTime(sec){
        sec = Math.floor(sec) || 0;
        const h = Math.floor(sec/3600);
        const m = Math.floor((sec%3600)/60);
        const s = sec%60;
        if(h>0) return h + ":" + String(m).padStart(2,'0') + ":" + String(s).padStart(2,'0');
        return m + ":" + String(s).padStart(2,'0');
      }

      function isFullscreenCard(){ return document.fullscreenElement === card || document.webkitFullscreenElement === card; }
      function isDeviceLandscape(){ return window.innerWidth > window.innerHeight; }
      function allowOverlayNow(){ return isFullscreenCard() || isDeviceLandscape(); }

      async function tryAutoplay(){
        try { await video.play(); } catch(e){ try { video.muted = true; await video.play(); } catch(_){} }
        updatePlayIcon();
      }
      function updatePlayIcon(){ insidePlay.textContent = video.paused ? '▶︎' : '❚❚'; }
      async function togglePlay(){ 
        try{ 
          if(video.paused){ 
            try{ video.muted = false; } catch(e){} 
            await video.play(); 
          } else video.pause(); 
        } catch(e){ console.warn(e);} 
        updatePlayIcon(); 
      }
      insidePlay.addEventListener('click', (e)=>{ e.stopPropagation(); togglePlay(); });

      insideForward.addEventListener('click', (e)=>{ e.stopPropagation(); video.currentTime = Math.min(video.duration || 0, video.currentTime + 10); });
      insideBack.addEventListener('click', (e)=>{ e.stopPropagation(); video.currentTime = Math.max(0, video.currentTime - 10); });

      let scrubbing = false;
      let wasPlayingBeforeScrub = false;
      function timeFromClientX(clientX){
        const r = seekBar.getBoundingClientRect();
        let p = (clientX - r.left) / r.width;
        p = Math.max(0, Math.min(1, p));
        return (video.duration || 0) * p;
      }
      function startScrub(clientX){
        wasPlayingBeforeScrub = !video.paused;
        try { video.pause(); } catch(e){}
        scrubbing = true;
        const t = timeFromClientX(clientX);
        video.currentTime = t;
        currentEl.textContent = formatTime(t);
        const pct = (t / (video.duration || 1)) * 100;
        fill.style.width = pct + '%';
        thumb.style.left = pct + '%';
      }
      function moveScrub(clientX){
        if(!scrubbing) return;
        const t = timeFromClientX(clientX);
        video.currentTime = t;
        currentEl.textContent = formatTime(t);
        const pct = (t / (video.duration || 1)) * 100;
        fill.style.width = pct + '%';
        thumb.style.left = pct + '%';
      }
      function endScrub(){
        if(!scrubbing) return;
        scrubbing = false;
        if(wasPlayingBeforeScrub){
          try { video.play().catch(()=>{}); } catch(e){}
        }
      }

      seekBar.addEventListener('mousedown', (e)=>{ e.preventDefault(); e.stopPropagation(); startScrub(e.clientX); });
      window.addEventListener('mousemove', (e)=>{ if(scrubbing) moveScrub(e.clientX); });
      window.addEventListener('mouseup', (e)=>{ if(scrubbing) endScrub(); });

      seekBar.addEventListener('touchstart', (e)=>{ e.preventDefault(); e.stopPropagation(); startScrub(e.touches[0].clientX); }, {passive:false});
      window.addEventListener('touchmove', (e)=>{ if(scrubbing && e.touches && e.touches[0]) moveScrub(e.touches[0].clientX); }, {passive:false});
      window.addEventListener('touchend', (e)=>{ if(scrubbing) endScrub(); });

      thumb.addEventListener('pointerdown', (e)=>{ e.preventDefault(); e.stopPropagation(); startScrub(e.clientX); });
      window.addEventListener('pointermove', (e)=>{ if(scrubbing && e.pointerType) moveScrub(e.clientX); });
      window.addEventListener('pointerup', (e)=>{ if(scrubbing) endScrub(); });

      video.addEventListener('timeupdate', ()=> {
        currentEl.textContent = formatTime(video.currentTime);
        const pct = (video.currentTime / (video.duration || 1)) * 100;
        fill.style.width = pct + '%';
        thumb.style.left = pct + '%';
        seekBar.setAttribute('aria-valuenow', Math.floor(video.currentTime || 0));
      });
      video.addEventListener('loadedmetadata', ()=> {
        durationEl.textContent = formatTime(video.duration || 0);
        seekBar.setAttribute('aria-valuemax', Math.floor(video.duration || 0));
      });
      video.addEventListener('play', updatePlayIcon);
      video.addEventListener('pause', updatePlayIcon);

      function showAll(){ controlsWrap.classList.remove('controls-hidden'); controlsWrap.classList.add('controls-visible'); insideMini.classList.remove('inside-hidden'); insideMini.classList.add('inside-visible'); }
      function hideAll(){ controlsWrap.classList.remove('controls-visible'); controlsWrap.classList.add('controls-hidden'); insideMini.classList.remove('inside-visible'); insideMini.classList.add('inside-hidden'); }
      function toggleAll(){ const isVisible = controlsWrap.classList.contains('controls-visible') && insideMini.classList.contains('inside-visible'); if(isVisible) hideAll(); else showAll(); }

      function isOverControls(target){
        return !!(target && (target.closest && (target.closest('.controls-wrap') || target.closest('.inside-mini-controls') || target.closest('.inside-item') || target.closest('.seek'))));
      }

      card.addEventListener('click', (e)=>{
        if(isOverControls(e.target)) return;
        togglePlay();
      });

      [insidePlay, insideForward, insideBack, seekBar, landscapeBtn, menuBtn].forEach(el=>{
        if(!el) return;
        el.addEventListener('click', e=>e.stopPropagation());
        el.addEventListener('pointerdown', e=>e.stopPropagation());
        el.addEventListener('touchstart', e=>e.stopPropagation(), {passive:false});
      });

      async function enterLandscapeMode(){
        try{
          const el = card;
          if (el.requestFullscreen) await el.requestFullscreen();
          else if (el.webkitRequestFullscreen) await el.webkitRequestFullscreen();
          if (screen.orientation && screen.orientation.lock) {
            try { await screen.orientation.lock('landscape'); } catch(e) {}
          }
        }catch(err){ console.warn('enterLandscape failed', err); }
        card.classList.add('landscape-mode');
        video.classList.add('contain');
        showAll();
      }
      async function exitLandscapeMode(){
        try{
          if (screen.orientation && screen.orientation.unlock) {
            try { screen.orientation.unlock(); } catch(e) {}
          }
          if (document.exitFullscreen) await document.exitFullscreen();
          else if (document.webkitExitFullscreen) await document.webkitExitFullscreen();
        }catch(err){ console.warn('exitLandscape failed', err); }
        card.classList.remove('landscape-mode');
        video.classList.remove('contain');
        showAll();
      }
      landscapeBtn.addEventListener('click', async (e)=>{ 
        e.stopPropagation(); 
        if(!isFullscreenCard()){ 
          await enterLandscapeMode(); 
        } else { 
          await exitLandscapeMode(); 
        } 
      });

      document.addEventListener('fullscreenchange', ()=> {
        if(document.fullscreenElement === card) {
          card.classList.add('landscape-mode');
          video.classList.add('contain');
          showAll();
        } else {
          card.classList.remove('landscape-mode');
          video.classList.remove('contain');
          showAll();
          if(menuOverlay.parentNode === card) document.body.appendChild(menuOverlay);
          if(langOverlay.parentNode === card) document.body.appendChild(langOverlay);
        }
      });

      let gesture = null;
      let indicatorTimeout = null;
      function showSwipeIndicator(kind, percent){
        swipeIcon.innerHTML = (kind === 'brightness') ? svgBrightness : svgVolume;
        swipeValue.textContent = percent + '%';
        swipeIndicator.classList.add('show');
        if(indicatorTimeout) clearTimeout(indicatorTimeout);
        indicatorTimeout = setTimeout(()=>{ swipeIndicator.classList.remove('show'); }, 800);
      }
      function clamp(v,a=0,b=1){ return Math.max(a, Math.min(b, v)); }
      function startLandscapeGesture(clientX, clientY){
        if(!card.classList.contains('landscape-mode')) return;
        const rect = card.getBoundingClientRect();
        const relX = clientX - rect.left;
        const leftLimit = rect.width * cornerRatio;
        const rightLimit = rect.width * (1 - cornerRatio);
        if(relX <= leftLimit){
          const styleFilter = getComputedStyle(video).filter || '';
          const match = styleFilter.match(/brightness\(([^\)]+)\)/);
          const initial = match ? parseFloat(match[1]) : 1;
          gesture = { type:'brightness', startY:clientY, initialValue: isNaN(initial) ? 1 : initial };
          showSwipeIndicator('brightness', Math.round(gesture.initialValue * 100));
        } else if(relX >= rightLimit){
          gesture = { type:'volume', startY:clientY, initialValue: video.volume };
          showSwipeIndicator('volume', Math.round(gesture.initialValue * 100));
        } else { gesture = null; }
      }
      function moveLandscapeGesture(clientY){
        if(!gesture) return;
        const rect = card.getBoundingClientRect();
        const delta = (gesture.startY - clientY);
        const pct = delta / rect.height;
        let newVal = gesture.initialValue + pct;
        newVal = clamp(newVal, 0, 1);
        if(gesture.type === 'brightness'){
          const applied = Math.max(0.05, newVal);
          video.style.filter = `brightness(${applied})`;
          showSwipeIndicator('brightness', Math.round(applied * 100));
        } else {
          video.volume = newVal;
          showSwipeIndicator('volume', Math.round(newVal * 100));
        }
      }
      function endLandscapeGesture(){
        if(!gesture) return;
        gesture = null;
        if(indicatorTimeout) clearTimeout(indicatorTimeout);
        indicatorTimeout = setTimeout(()=>{ swipeIndicator.classList.remove('show'); }, 600);
      }
      card.addEventListener('touchstart', (e)=>{ if(!card.classList.contains('landscape-mode')) return; const t = e.touches[0]; startLandscapeGesture(t.clientX, t.clientY); }, {passive:false});
      card.addEventListener('touchmove', (e)=>{ if(!card.classList.contains('landscape-mode')) return; const t = e.touches[0]; moveLandscapeGesture(t.clientY); }, {passive:false});
      card.addEventListener('touchend', ()=>{ if(!card.classList.contains('landscape-mode')) return; endLandscapeGesture(); });

      const sourceUrl = video.querySelector('source')?.src || '';
      video.addEventListener('error', async (e)=>{
        try {
          const r = await fetch(sourceUrl, { method: 'HEAD', mode: 'cors' });
          if(!r.ok) showError('Le serveur répond ' + r.status + '.');
        } catch(fetchErr){
          console.error('HEAD failed', fetchErr);
          showError('Probable CORS (Access-Control-Allow-Origin absent). Ouvri console pour détails.');
        }
      });
      function showError(msg){ errTxt.textContent = msg; errorBox.style.display='block'; }

      let menuWasOpenBeforeLang = false;

      function placeOverlayInsideCard(overlay){
        if(overlay.parentNode !== card) card.appendChild(overlay);
        overlay.style.position = 'absolute';
        overlay.style.inset = '0';
        overlay.style.zIndex = '99999';
      }
      function placeOverlayBackToBody(overlay){
        if(overlay.parentNode !== document.body) document.body.appendChild(overlay);
        overlay.style.position = 'fixed';
        overlay.style.inset = '0';
        overlay.style.zIndex = '99999';
      }

      function openMenuOverlay(){
        if(!allowOverlayNow()) return;
        placeOverlayInsideCard(menuOverlay);
        menuOverlay.classList.add('show');
        menuOverlay.setAttribute('aria-hidden','false');
        langOverlay.classList.remove('show');
        langOverlay.setAttribute('aria-hidden','true');
        hideAll();
      }
      function closeMenuOverlay(){
        menuOverlay.classList.remove('show');
        menuOverlay.setAttribute('aria-hidden','true');
        showAll();
        if(!allowOverlayNow()) placeOverlayBackToBody(menuOverlay);
      }

      function openLangOverlay(){
        if(!allowOverlayNow()) return;
        menuWasOpenBeforeLang = menuOverlay.classList.contains('show');
        placeOverlayInsideCard(langOverlay);
        menuOverlay.classList.remove('show');
        menuOverlay.setAttribute('aria-hidden','true');
        langOverlay.classList.add('show');
        langOverlay.setAttribute('aria-hidden','false');
        hideAll();
      }
      function closeLangOverlay(){
        langOverlay.classList.remove('show');
        langOverlay.setAttribute('aria-hidden','true');
        if(menuWasOpenBeforeLang){
          menuOverlay.classList.add('show');
          menuOverlay.setAttribute('aria-hidden','false');
          menuWasOpenBeforeLang = false;
        } else {
          showAll();
        }
        if(!allowOverlayNow()) placeOverlayBackToBody(langOverlay);
      }

      menuBtn.addEventListener('click', (e)=>{
        e.stopPropagation();
        openMenuOverlay();
      });

      menuCloseBtn.addEventListener('click', (e)=>{ e.stopPropagation(); closeMenuOverlay(); });
      menuBackdrop.addEventListener('click', ()=>{ closeMenuOverlay(); });
      langCloseBtn.addEventListener('click', (e)=>{ e.stopPropagation(); closeLangOverlay(); });
      langBackdrop.addEventListener('click', ()=>{ closeLangOverlay(); });

      menuLang.addEventListener('click', (e)=>{ e.stopPropagation(); openLangOverlay(); });
      menuPip.addEventListener('click', async (e)=>{
        e.stopPropagation();
        try {
          if(document.pictureInPictureElement) {
            await document.exitPictureInPicture();
            pipStatus.textContent = 'Activer';
          } else {
            try { await video.play(); } catch(_){}
            if (video.requestPictureInPicture) {
              await video.requestPictureInPicture();
              pipStatus.textContent = 'Désactiver';
            } else if (video.webkitSetPresentationMode) {
              try { video.webkitSetPresentationMode('picture-in-picture'); pipStatus.textContent = 'Désactiver'; }
              catch(err){ console.warn('webkit PIP failed', err); alert('PiP non supporté par ce navigateur'); }
            } else {
              alert('Picture-in-Picture non supporté sur ce navigateur.');
            }
          }
        } catch(err){
          console.warn('PiP failed', err);
          pipStatus.textContent = 'Erreur';
          setTimeout(()=>{ pipStatus.textContent = 'Activer'; }, 1400);
        } finally {
          setTimeout(()=> { if(document.pictureInPictureElement) closeMenuOverlay(); }, 300);
        }
      });

      langBackBtn.addEventListener('click', (e)=>{ e.stopPropagation(); closeLangOverlay(); });

      window.addEventListener('keydown', (e)=>{
        if(e.key === 'Escape'){
          if(langOverlay.classList.contains('show')) closeLangOverlay();
          else if(menuOverlay.classList.contains('show')) closeMenuOverlay();
        }
      });

      window.addEventListener('orientationchange', ()=>{
        if(!allowOverlayNow()){
          if(menuOverlay.classList.contains('show')) closeMenuOverlay();
          if(langOverlay.classList.contains('show')) closeLangOverlay();
          placeOverlayBackToBody(menuOverlay);
          placeOverlayBackToBody(langOverlay);
        }
      });
      window.addEventListener('resize', ()=>{
        if(!allowOverlayNow()){
          if(menuOverlay.classList.contains('show')) closeMenuOverlay();
          if(langOverlay.classList.contains('show')) closeLangOverlay();
          placeOverlayBackToBody(menuOverlay);
          placeOverlayBackToBody(langOverlay);
        }
      });

      tryAutoplay();
      showAll();
    }

    function displaySocialLinks(){
      const c = document.getElementById("explorerView"),
            s = document.createElement("div");
      s.className = "social-section";
      s.innerHTML = `
        <a href="https://www.facebook.com/profile.php?id=61578852256333" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
          <i class="fab fa-facebook-f" aria-hidden="true"></i>
        </a>
        <a href="mailto:dhaitiadam@gmail.com" rel="noopener noreferrer" aria-label="Mail">
          <i class="fas fa-envelope" aria-hidden="true"></i>
        </a>
        <a href="https://whatsapp.com/channel/0029Vb6WLps7oQhWrUlyPQ2m" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp">
          <i class="fab fa-whatsapp" aria-hidden="true"></i>
        </a>
        <a href="https://www.instagram.com/adam_dhaiti/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
          <i class="fab fa-instagram" aria-hidden="true"></i>
        </a>
        <a href="https://youtube.com/@adam_dhaiti?si=f_29jvZi6c1mJaBO" target="_blank" rel="noopener noreferrer" aria-label="YouTube">
          <i class="fab fa-youtube" aria-hidden="true"></i>
        </a>
      `;
      const exists = Array.from(document.getElementsByClassName('social-section')).length;
      if (!exists) c.appendChild(s);
    }

    window.getAdLogs = function() {
      try { return JSON.parse(localStorage.getItem('adLogs') || '[]'); } catch(e) { return []; }
    };
  </script>
  <script>
    window._swReg = null;
    function showUpdateBanner() {
      if (document.getElementById('sw-update-banner')) return;
      const banner = document.createElement('div');
      banner.id = 'sw-update-banner';
      banner.innerHTML = `
        <div style="flex:1;text-align:left">Nouvo vèsyon disponib.</div>
        <div style="display:flex;gap:8px">
          <button id="sw-update-btn">Mete ajou</button>
          <button id="sw-dismiss-btn" style="background:transparent;border:1px solid #444;color:#fff;padding:8px 10px;border-radius:6px;cursor:pointer">Fèmen</button>
        </div>`;
      document.body.appendChild(banner);

      document.getElementById('sw-update-btn').addEventListener('click', () => {
        if (!window._swReg) return location.reload();
        if (window._swReg.waiting) {
          window._swReg.waiting.postMessage({ type: 'SKIP_WAITING' });
        }
        setTimeout(() => location.reload(), 1500);
      });

      document.getElementById('sw-dismiss-btn').addEventListener('click', () => {
        const el = document.getElementById('sw-update-banner');
        if (el && el.parentNode) el.parentNode.removeChild(el);
      });
    }

    navigator.serviceWorker && navigator.serviceWorker.addEventListener('controllerchange', () => {
      try {
        if (!window.__sw_reload_attempted) {
          window.__sw_reload_attempted = true;
          location.reload();
        }
      } catch(e){}
    });

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js?v=2')
          .then(reg => {
            window._swReg = reg;
            if (reg.waiting) {
              showUpdateBanner();
            }
            reg.onupdatefound = () => {
              const newSW = reg.installing;
              newSW.addEventListener('statechange', () => {
                if (newSW.state === 'installed') {
                  if (navigator.serviceWorker.controller) {
                    showUpdateBanner();
                  }
                }
              });
            };
          })
          .catch(err => console.warn('SW register failed:', err));
      });
    }
  </script>
  <script>
    document.addEventListener('gesturestart', function(e) { e.preventDefault(); });
    document.addEventListener('touchmove', function (e) {
      if (e.scale && e.scale !== 1) { e.preventDefault(); }
    }, { passive: false });

    (function() {
      let lastTouch = 0;
      document.addEventListener('touchend', function(e) {
        const now = Date.now();
        if (now - lastTouch <= 300) {
          const tag = (e.target && e.target.tagName) || '';
          if (['INPUT','TEXTAREA','SELECT'].indexOf(tag) === -1) {
            e.preventDefault();
          }
        }
        lastTouch = now;
      }, { passive: false });
    })();
  </script> 
  <script type='text/javascript' src='//pl28135197.effectivegatecpm.com/3b/5a/09/3b5a097d28211945158c20a3f4879260.js'></script>
  <script>
(function(){
  const PAYPAL_URL = 'https://www.paypal.com/ncp/payment/MCJHCJ85AC5AJ';

  const logo = document.querySelector('.header .logo');
  if(!logo){
    console.warn('Logo pa jwenn. Asire ou gen <div class="logo"> nan header.');
    return;
  }

  if (!logo.hasAttribute('tabindex')) logo.setAttribute('tabindex', '0');
  logo.setAttribute('role', 'link');

  let handled = false;

  function openPaypal(){
    window.open(PAYPAL_URL, '_blank', 'noopener,noreferrer');
  }

  logo.addEventListener('pointerdown', ()=>{ handled=false; });
  logo.addEventListener('pointerup', ()=>{ handled=true; openPaypal(); });
  logo.addEventListener('click', ()=>{ if(!handled) openPaypal(); });

  logo.addEventListener('keydown', (e)=>{
    if(e.key==='Enter' || e.key===' '){
      e.preventDefault();
      openPaypal();
    }
  });
})();
  </script>
  <style>
  body, body * {
    -webkit-user-select: none !important;
    -moz-user-select: none !important;
    -ms-user-select: none !important;
    user-select: none !important;
  }

  .post-name,
  input, textarea {
    -webkit-user-select: text !important;
    -moz-user-select: text !important;
    -ms-user-select: text !important;
    user-select: text !important;
  }

  .post-name { cursor:text; }
</style>
  <script>
  document.addEventListener('-visible');
